<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8" />
  <title>YouTube ã‚³ãƒ¡ãƒ³ãƒˆè¡¨ç¤º</title>
  <style>
    body {
      font-family: sans-serif;
      margin: 20px;
    }
    .comment {
      display: flex;
      align-items: flex-start;
      gap: 10px;
      border-bottom: 1px solid #ccc;
      padding: 10px 0;
    }
    .avatar {
      width: 48px;
      height: 48px;
      border-radius: 50%;
    }
    .content {
      flex: 1;
    }
    .author {
      font-weight: bold;
      margin-bottom: 5px;
    }
    .text {
      margin-bottom: 5px;
    }
    .meta {
      font-size: 0.9em;
      color: #666;
    }
  </style>
</head>
<body>
  <h2>æœ€æ–°ã®YouTubeã‚³ãƒ¡ãƒ³ãƒˆï¼ˆ2ç•ªç›®ã‚’è¡¨ç¤ºï¼‰</h2>
  <div id="comment">èª­ã¿è¾¼ã¿ä¸­...</div>

  <script>
    const videoId = "niKAylKNIEI";
    const apiKey = "AIzaSyD16N5V2IC47CAlgWxmfufk6HfBXpdB4rE";

    async function fetchSecondLatestComment() {
      const url = `https://www.googleapis.com/youtube/v3/commentThreads?part=snippet&videoId=${videoId}&order=time&maxResults=5&key=${apiKey}`;
      const commentDiv = document.getElementById("comment");

      try {
        const res = await fetch(url);
        const data = await res.json();

        const comments = data.items;

        if (!comments || comments.length < 2) {
          commentDiv.textContent = "2ä»¶ä»¥ä¸Šã®ã‚³ãƒ¡ãƒ³ãƒˆãŒè¦‹ã¤ã‹ã‚Šã¾ã›ã‚“ã€‚";
          return;
        }

        const commentData = comments[1].snippet.topLevelComment.snippet;

        const html = `
          <div class="comment">
            <img class="avatar" src="${commentData.authorProfileImageUrl}" alt="avatar" />
            <div class="content">
              <div class="author">${commentData.authorDisplayName}</div>
              <div class="text">${commentData.textDisplay}</div>
              <div class="meta">ğŸ‘ ${commentData.likeCount} ï½œ ğŸ’¬ ${comments[1].snippet.totalReplyCount} ä»¶ã®è¿”ä¿¡</div>
            </div>
          </div>
        `;

        commentDiv.innerHTML = html;

      } catch (err) {
        console.error("å–å¾—ã‚¨ãƒ©ãƒ¼:", err);
        commentDiv.textContent = "ã‚³ãƒ¡ãƒ³ãƒˆã®å–å¾—ã«å¤±æ•—ã—ã¾ã—ãŸã€‚";
      }
    }

    // åˆå›å®Ÿè¡Œ
    fetchSecondLatestComment();

    // 15ç§’ã”ã¨ã«æ›´æ–°
    setInterval(fetchSecondLatestComment, 5000);
  </script>
</body>
</html>
